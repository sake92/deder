amends "../../config/DederProject.pkl"

local const scalaVersions = List("2.13.18", "3.7.4")

local const commonModules: List<ScalaModule> =
  scalaVersions
    .map((sv) ->
      new CreateCrossModules {
        _root = "common"
        _template = new {
          scalaVersion = sv
          pomSettings {
            groupId = "ba.sake"
            artifactId = "deder-cross-common"
            version = "0.1.4-SNAPSHOT"
          }
          deps {
            "com.softwaremill.sttp.client3::core::3.11.0"
          }
        }
        _jsTemplate = (_template.asJs()) {
          scalaJsVersion = "1.20.2"
        }
        _nativeTemplate = (_template.asNative()) {
          scalaNativeVersion = "0.5.10"
        }
      }
        .get
        .all
    )
    .flatten()

modules {
  ...commonModules.filter((m) -> !m.id.endsWith("-native-3.7.4"))
}

