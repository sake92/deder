amends "../../config/DederProject.pkl"

//amends "https://sake92.github.io/deder/config/DederProject.pkl"

local const baseModule: ScalaModule = new {
  // scalaVersion = "2.12.21" // TODO fix scala 2.12 support
  // scalaVersion = "2.13.18"
  scalaVersion = "3.7.4"
}

local const common = (baseModule) {
  id = "common"
  deps {
    "org.jsoup:jsoup:1.21.1"
  }
}

local const frontend = (baseModule) {
  id = "frontend"
  moduleDeps { common }
}

local const backend = (baseModule) {
  id = "backend"
  moduleDeps { common }
}

local const uberModules = new CreateScalaModules {
  _root = "uber"
  _template = (baseModule) {
    moduleDeps { frontend; backend }
    deps {
      "com.lihaoyi::pprint:0.9.5"
    }
    mainClass = "uber.Main"
  }
  _testTemplate = (_template.asTest()) {
    deps {
      "org.scalameta::munit:1.2.1"
    }
  }
}.get

modules {
  common
  frontend
  backend
  ...uberModules.all
}
