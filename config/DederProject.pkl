module ba.sake.deder.config.DederProject

modules: Listing<DederModule>

abstract class DederModule {
  /// Module id, used in CLI and referring from other modules
  id: String(idValidation)

  /// Module root directory, relative to project root
  root: String(rootValidation) = id

  /// Module dependencies
  moduleDeps: Listing<DederModule>

  type: ModuleType

  hidden idValidation = (value) ->
    if (value.isBlank) throw("Id must not be blank.")
    else true

  hidden rootValidation = (value) ->
      if (value.isBlank) throw("Id must not be blank.")
      else true
}

// TODO remove ??
typealias ModuleType = "java" | "scala"


class JavaModule extends DederModule {
  type: ModuleType = "java"
  /// Source directories
  sources: Listing<String> = new Listing { "src" }
  resources: Listing<String> = new Listing { "resources" }
  javacOptions: Listing<String> = new Listing { }
  mainClass: String? = null
  deps: Listing<String> = new Listing { } // maven/ivy deps
}

class ScalaModule extends DederModule {
  type: ModuleType = "scala"
  scalaVersion: String
  /// Source directories
  sources: Listing<String> = new Listing { "src" }
  resources: Listing<String> = new Listing { "resources" }
  javacOptions: Listing<String> = new Listing { }
  scalacOptions: Listing<String> = new Listing { }
  mainClass: String? = null
  deps: Listing<String> = new Listing { } // maven/ivy deps
}
